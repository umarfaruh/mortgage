<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <h1><big><strong>–§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä—ã </strong></big></h1>
  <title>–ò–ø–æ—Ç–µ–∫–∞ ‚Äî –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –∏ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫</title>
  <body>
  <!-- üîπ –ù–∞–≤–∏–≥–∞—Ü–∏–æ–Ω–Ω–∞—è –ø–∞–Ω–µ–ª—å -->
   <div class="navbar">
    <a href="https://umarfaruh.github.io/budget.rk/">–î–æ—Ö–æ–¥—ã –∏ —Ä–∞—Å—Ö–æ–¥—ã</a>
    <a href="https://umarfaruh.github.io/financial_management/">–ù–∞–ª–æ–≥–æ–≤—ã–π –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä</a>
    <a href="https://umarfaruh.github.io/Expenses-calculate-your-expenses-correctly/">–ù–∞–∫–æ–ø–∏ –Ω–∞ –º–µ—á—Ç—É</a>
    <a href="https://umarfaruh.github.io/mortgage/">–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –∏–ø–æ—Ç–µ–∫–∏</a>
  </div>

  <style>
    /* üî∏ –û—Å–Ω–æ–≤–Ω—ã–µ —Å—Ç–∏–ª–∏ –ø–∞–Ω–µ–ª–∏ */
    .navbar {
      display: flex;
      justify-content: center;
      align-items: center;
      flex-wrap: wrap;
      gap: 30px;
      padding: 20px;
      border-radius: 0px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      margin: 0px;
    }

    /* üî∏ –ö–Ω–æ–ø–∫–∏ */
    .navbar a {
      background-color: #050506;
      color: white;
      text-decoration: none;
      padding: 12px 40px;
      border-radius: 8px;
      font-weight: 600;
      transition: all 0.3s ease;
    }

    /* üî∏ –ü—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏ */
    .navbar a:hover {
      background-color:  #141519;
      transform: translateY(-2px);
    }

    /* üî∏ –î–ª—è —Ç–µ–ª–µ—Ñ–æ–Ω–∞ (–∞–¥–∞–ø—Ç–∏–≤) */
    @media (max-width: 400px) {
      .navbar {
        flex-direction: column;
        align-items: stretch;
      }
      .navbar a {
        width: 100%;
        text-align: center;
      }
    }
  </style>
  </body>
  <style>
    :root{--bg:#f4f7fb;--card:#ffffff;--accent:#050606;--muted:#6b7280;--glass: rgba(255,255,255,0.7)}
    *{box-sizing:border-box}
    body{font-family:Inter, system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial; margin:0; background:linear-gradient(180deg,#eef3ff 0%,var(--bg) 100%); color:#0f172a}
    .container{max-width:1100px;margin:32px auto;padding:24px}
    header{display:flex;align-items:center;gap:16px;margin-bottom:20px}
    .logo{width:56px;height:56px;border-radius:8px;background:var(--accent);display:flex;align-items:center;justify-content:center;color:white;font-weight:700;font-size:20px}
    h1{margin:0;font-size:22px}
    p.lead{color:var(--muted);margin:6px 0 0}

    .grid{display:grid;grid-template-columns:1fr 380px;gap:18px}
    @media (max-width:900px){.grid{grid-template-columns:1fr} .sidebar{order:-1}}

    .card{background:var(--card);border-radius:12px;padding:18px;box-shadow:0 6px 18px rgba(17,24,39,0.06)}
    label{display:block;font-size:13px;color:var(--muted);margin-bottom:6px}
    input[type=text], input[type=number], select{width:100%;padding:10px 12px;border:1px solid #e6e9ef;border-radius:8px;font-size:15px}
    .row{display:flex;gap:12px}
    .row > *{flex:1}
    button{background:var(--accent);color:#fff;border:0;padding:10px 14px;border-radius:10px;font-weight:600;cursor:pointer}
    button.secondary{background:transparent;color:var(--accent);border:1px solid rgba(23,102,255,0.15)}
    .result{display:flex;gap:12px;flex-wrap:wrap}
    .stat{flex:1;min-width:160px;background:linear-gradient(180deg,rgba(23,102,255,0.05),transparent);padding:12px;border-radius:8px}
    .stat b{display:block;font-size:18px}
    table{width:100%;border-collapse:collapse;margin-top:12px}
    th, td{padding:8px;border-bottom:1px solid #eef2f7;text-align:right;font-size:13px}
    th{background:transparent;text-align:left;color:var(--muted)}
    .muted{color:var(--muted)}
    footer{margin-top:20px;text-align:center;color:var(--muted);font-size:13px}
    .faq h3{margin-top:0}
    .tips li{margin-bottom:8px}
    .download{margin-top:10px;display:flex;gap:8px}
  </style>
</head>
<body>
  <div class="container">
    <header>
      <div class="logo">–ò–ü</div>
      <div>
        <h1>–ò–ø–æ—Ç–µ—á–Ω—ã–π –ø–æ–º–æ—â–Ω–∏–∫</h1>
        <p class="lead">–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –ø–ª–∞—Ç–µ–∂–µ–π, –∞–º–æ—Ä—Ç–∏–∑–∞—Ü–∏—è, —Å–æ–≤–µ—Ç—ã –∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –∫—Ä–µ–¥–∏—Ç–æ–≤ ‚Äî –≤—Å—ë –≤ –æ–¥–Ω–æ–º –º–µ—Å—Ç–µ.</p>
      </div>
    </header>

    <main class="grid">
      <section>
        <div class="card">
          <h2>–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –∏–ø–æ—Ç–µ–∫–∏</h2>
          <p class="muted">–í–≤–æ–¥–∏ —Å—É–º–º—É –∫—Ä–µ–¥–∏—Ç–∞, –ø—Ä–æ—Ü–µ–Ω—Ç –∏ —Å—Ä–æ–∫ ‚Äî –ø–æ–ª—É—á–∏—à—å –µ–∂–µ–º–µ—Å—è—á–Ω—ã–π –ø–ª–∞—Ç—ë–∂ –∏ –≥—Ä–∞—Ñ–∏–∫ –≤—ã–ø–ª–∞—Ç.</p>

          <div style="margin-top:12px">
            <label for="amount">–°—É–º–º–∞ –∫—Ä–µ–¥–∏—Ç–∞ (‚Ç∏)</label>
            <input id="amount" type="number" min="0" step="10000" placeholder="–Ω–∞–ø—Ä–∏–º–µ—Ä 15 000 000" />

            <div class="row" style="margin-top:10px">
              <div>
                <label for="rate">–ì–æ–¥–æ–≤–∞—è —Å—Ç–∞–≤–∫–∞ (%)</label>
                <input id="rate" type="number" min="0" step="0.01" placeholder="–Ω–∞–ø—Ä–∏–º–µ—Ä 9.5" />
              </div>
              <div>
                <label for="term">–°—Ä–æ–∫ (–ª–µ—Ç)</label>
                <input id="term" type="number" min="1" max="50" step="1" placeholder="–Ω–∞–ø—Ä–∏–º–µ—Ä 20" />
              </div>
            </div>

            <div class="row" style="margin-top:10px">
              <div>
                <label for="down">–ü–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω—ã–π –≤–∑–Ω–æ—Å (‚Ç∏)</label>
                <input id="down" type="number" min="0" step="10000" placeholder="–Ω–∞–ø—Ä–∏–º–µ—Ä 3 000 000" />
              </div>
              <div>
                <label for="extra">–î–æ–ø. –ø–ª–∞—Ç–µ–∂ –≤ –º–µ—Å. (‚Ç∏)</label>
                <input id="extra" type="number" min="0" step="1000" placeholder="–¥–æ–ø. –ø–ª–∞—Ç–µ–∂ –¥–ª—è –¥–æ—Å—Ä–æ—á–∫–∏" />
              </div>
            </div>

            <div style="display:flex;gap:8px;margin-top:12px;align-items:center">
              <button id="calc">–†–∞—Å—Å—á–∏—Ç–∞—Ç—å</button>
              <button id="clear" class="secondary">–°–±—Ä–æ—Å–∏—Ç—å</button>
              <div style="margin-left:auto;color:var(--muted);font-size:13px">*–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –±—Ä–∞—É–∑–µ—Ä–µ</div>
            </div>

            <div id="results" style="margin-top:14px;display:none">
              <div class="result">
                <div class="stat"><div class="muted">–ï–∂–µ–º–µ—Å—è—á–Ω—ã–π –ø–ª–∞—Ç—ë–∂</div><b id="monthly">‚Äî</b></div>
                <div class="stat"><div class="muted">–í—Å–µ–≥–æ –≤—ã–ø–ª–∞—á–µ–Ω–æ</div><b id="totalPaid">‚Äî</b></div>
                <div class="stat"><div class="muted">–ü–µ—Ä–µ–ø–ª–∞—Ç–∞ (–ø—Ä–æ—Ü–µ–Ω—Ç—ã)</div><b id="totalInterest">‚Äî</b></div>
              </div>

              <div style="margin-top:12px;display:flex;gap:8px;align-items:center">
                <label class="muted" style="margin:0">–ü–æ–∫–∞–∑–∞—Ç—å –≥—Ä–∞—Ñ–∏–∫</label>
                <select id="showRows">
                  <option value="12">–ü–µ—Ä–≤—ã–µ 12 –º–µ—Å.</option>
                  <option value="60">–ü–µ—Ä–≤—ã–µ 60 –º–µ—Å.</option>
                  <option value="all">–í–µ—Å—å –≥—Ä–∞—Ñ–∏–∫</option>
                </select>
                <div style="margin-left:auto" class="download">
                  <button id="downloadCsv" class="secondary">–°–∫–∞—á–∞—Ç—å CSV</button>
                  <button id="print" class="secondary">–ü–µ—á–∞—Ç—å</button>
                </div>
              </div>

              <div style="overflow:auto;margin-top:10px;max-height:360px">
                <table id="table">
                  <thead>
                    <tr><th>–ú–µ—Å—è—Ü</th><th>–ü–ª–∞—Ç—ë–∂</th><th>–û—Å–Ω–æ–≤–Ω–æ–π –¥–æ–ª–≥</th><th>–ü—Ä–æ—Ü–µ–Ω—Ç—ã</th><th>–û—Å—Ç–∞—Ç–æ–∫</th></tr>
                  </thead>
                  <tbody></tbody>
                </table>
              </div>
            </div>

          </div>
        </div>

        <div class="card" style="margin-top:14px">
          <h3>–ß—Ç–æ —Ç–∞–∫–æ–µ –∏–ø–æ—Ç–µ–∫–∞</h3>
          <p class="muted">–ò–ø–æ—Ç–µ–∫–∞ ‚Äî —ç—Ç–æ –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–π –∫—Ä–µ–¥–∏—Ç –ø–æ–¥ –∑–∞–ª–æ–≥ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏. –ö–ª—é—á–µ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã: —Å—É–º–º–∞ –∫—Ä–µ–¥–∏—Ç–∞, —Å—Ç–∞–≤–∫–∞, —Å—Ä–æ–∫ –∏ –ø–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω—ã–π –≤–∑–Ω–æ—Å. –í–∞–∂–Ω–æ —É—á–∏—Ç—ã–≤–∞—Ç—å –∫–æ–º–∏—Å—Å–∏–∏, —Å—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–µ –∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –¥–æ—Å—Ä–æ—á–Ω—ã—Ö –ø–æ–≥–∞—à–µ–Ω–∏–π.</p>

          <h3 style="margin-top:12px">–°–æ–≤–µ—Ç—ã</h3>
          <ul class="tips muted">
            <li>–°—Ä–∞–≤–Ω–∏–≤–∞–π —Ä–µ–∞–ª—å–Ω—ã–µ –≥–æ–¥–æ–≤—ã–µ —Å—Ç–∞–≤–∫–∏ (APR), –∞ –Ω–µ —Ç–æ–ª—å–∫–æ –Ω–æ–º–∏–Ω–∞–ª—å–Ω—É—é.</li>
            <li>–£–≤–µ–ª–∏—á–µ–Ω–∏–µ –ø–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–æ–≥–æ –≤–∑–Ω–æ—Å–∞ —Å–Ω–∏–∂–∞–µ—Ç –µ–∂–µ–º–µ—Å—è—á–Ω—ã–π –ø–ª–∞—Ç—ë–∂ –∏ –ø–µ—Ä–µ–ø–ª–∞—Ç—É.</li>
            <li>–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –µ–∂–µ–º–µ—Å—è—á–Ω—ã–µ –≤–∑–Ω–æ—Å—ã –∑–∞–º–µ—Ç–Ω–æ —Å–æ–∫—Ä–∞—â–∞—é—Ç —Å—Ä–æ–∫ –∏ –ø—Ä–æ—Ü–µ–Ω—Ç—ã.</li>
            <li>–í—ã–±–∏—Ä–∞–π –∫—Ä–µ–¥–∏—Ç —Å –≥–∏–±–∫–∏–º–∏ —É—Å–ª–æ–≤–∏—è–º–∏ –¥–æ—Å—Ä–æ—á–Ω–æ–≥–æ –ø–æ–≥–∞—à–µ–Ω–∏—è.</li>
          </ul>
        </div>

        <div class="card faq" style="margin-top:14px">
          <h3>–ß–∞—Å—Ç—ã–µ –≤–æ–ø—Ä–æ—Å—ã</h3>
          <p><strong>–ö–∞–∫ —Å–Ω–∏–∑–∏—Ç—å —Å—Ç–∞–≤–∫—É?</strong> ‚Äî –£–ª—É—á—à–∏—Ç—å –∫—Ä–µ–¥–∏—Ç–Ω—É—é –∏—Å—Ç–æ—Ä–∏—é, —É–≤–µ–ª–∏—á–∏—Ç—å –≤–∑–Ω–æ—Å, —Å—Ä–∞–≤–Ω–∏—Ç—å –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –±–∞–Ω–∫–æ–≤.</p>
          <p><strong>–ù—É–∂–Ω–æ –ª–∏ —Å—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–µ?</strong> ‚Äî –ú–Ω–æ–≥–∏–µ –±–∞–Ω–∫–∏ —Ç—Ä–µ–±—É—é—Ç —Å—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–µ –∂–∏–∑–Ω–∏ –∏–ª–∏ –∏–º—É—â–µ—Å—Ç–≤–∞.</p>
        </div>
      </section>

      <aside class="sidebar">
        <div class="card">
          <h3>–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π</h3>
          <p class="muted">–í–≤–µ–¥–∏—Ç–µ –ø—Ä–∏–º–µ—Ä–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —ç—Ç—É —Å–µ–∫—Ü–∏—é –∫–∞–∫ –∑–∞–º–µ—Ç–∫–∏ –ø—Ä–∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏–∏ –±–∞–Ω–∫–æ–≤.</p>
          <label for="bankName">–ë–∞–Ω–∫ / –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ</label>
          <input id="bankName" type="text" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –±–∞–Ω–∫–∞" />
          <label style="margin-top:8px">–°—Ç–∞–≤–∫–∞ (%)</label>
          <input id="bankRate" type="number" step="0.01" />
          <button id="saveOffer" style="margin-top:8px">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ</button>

          <div id="offers" style="margin-top:12px"></div>
        </div>
      </aside>
    </main>

  </div>

  <script>
    // –£—Ç–∏–ª–∏—Ç—ã —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
    function fmt(num){return Number(num).toLocaleString('ru-RU',{maximumFractionDigits:0})}
    function fmtMoney(num){return Number(num).toLocaleString('ru-RU',{minimumFractionDigits:0,maximumFractionDigits:0}) + ' ‚Ç∏'}
    function fmtMoney2(num){return Number(num).toLocaleString('ru-RU',{minimumFractionDigits:2,maximumFractionDigits:2}) + ' ‚Ç∏'}

    // –ü–æ–ª—É—á–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç—ã
    const amount = document.getElementById('amount');
    const rate = document.getElementById('rate');
    const term = document.getElementById('term');
    const down = document.getElementById('down');
    const extra = document.getElementById('extra');
    const calc = document.getElementById('calc');
    const clear = document.getElementById('clear');
    const results = document.getElementById('results');
    const monthlyEl = document.getElementById('monthly');
    const totalPaidEl = document.getElementById('totalPaid');
    const totalInterestEl = document.getElementById('totalInterest');
    const tableBody = document.querySelector('#table tbody');
    const showRows = document.getElementById('showRows');
    const downloadCsv = document.getElementById('downloadCsv');
    const printBtn = document.getElementById('print');

    // Offers
    const bankName = document.getElementById('bankName');
    const bankRate = document.getElementById('bankRate');
    const saveOffer = document.getElementById('saveOffer');
    const offersBox = document.getElementById('offers');

    // –õ–æ–∫–∞–ª—å–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ
    const LS_KEY = 'mortgage_helper_v1';
    function saveState(){
      const state = {amount:amount.value, rate:rate.value, term:term.value, down:down.value, extra:extra.value};
      localStorage.setItem(LS_KEY, JSON.stringify(state));
    }
    function loadState(){
      const s = localStorage.getItem(LS_KEY);
      if(!s) return;
      try{const st=JSON.parse(s); amount.value=st.amount||''; rate.value=st.rate||''; term.value=st.term||''; down.value=st.down||''; extra.value=st.extra||'';}catch(e){}
    }

    // Offers storage
    const OFFERS_KEY = 'mortgage_offers_v1';
    function loadOffers(){
      const raw = localStorage.getItem(OFFERS_KEY);
      let list = [];
      if(raw) try{list = JSON.parse(raw)}catch(e){}
      renderOffers(list);
    }
    function renderOffers(list){
      offersBox.innerHTML = '';
      if(!list.length){offersBox.innerHTML = '<div class="muted">–ù–µ—Ç —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã—Ö –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π</div>'; return}
      list.forEach((o,i)=>{
        const el = document.createElement('div');
        el.style.padding='8px 0'; el.style.borderBottom='1px solid #f1f5f9';
        el.innerHTML = `<div style="display:flex;justify-content:space-between;align-items:center"><div><strong>${o.name}</strong><div class="muted">${o.rate}% –≥–æ–¥–æ–≤—ã—Ö</div></div><div><button data-i="${i}" class="secondary">–£–¥–∞–ª–∏—Ç—å</button></div></div>`;
        offersBox.appendChild(el);
      });
      // –¥–µ–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —É–¥–∞–ª–µ–Ω–∏—è
      offersBox.querySelectorAll('button').forEach(btn=>btn.addEventListener('click',e=>{
        const idx = +e.currentTarget.dataset.i;
        list.splice(idx,1); localStorage.setItem(OFFERS_KEY, JSON.stringify(list)); renderOffers(list);
      }))
    }

    saveOffer.addEventListener('click', ()=>{
      const name = bankName.value.trim(); const r = bankRate.value.trim();
      if(!name || !r) return alert('–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –±–∞–Ω–∫–∞ –∏ —Å—Ç–∞–≤–∫—É');
      let list = [];
      try{list = JSON.parse(localStorage.getItem(OFFERS_KEY)||'[]')}catch(e){}
      list.push({name, rate:r});
      localStorage.setItem(OFFERS_KEY, JSON.stringify(list)); bankName.value=''; bankRate.value=''; loadOffers();
    })

    // –†–∞—Å—á—ë—Ç
    function calcMortgage(){
      const P = Number(amount.value) - Number(down.value||0);
      const annualRate = Number(rate.value);
      const years = Number(term.value);
      const extraPay = Number(extra.value||0);
      if(!P || isNaN(P) || P<=0) return alert('–í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—É—é —Å—É–º–º—É –∫—Ä–µ–¥–∏—Ç–∞ (–ø–æ—Å–ª–µ –≤—ã—á–µ—Ç–∞ –ø–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–æ–≥–æ –≤–∑–Ω–æ—Å–∞).');
      if(!annualRate || isNaN(annualRate)) return alert('–í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—É—é –≥–æ–¥–æ–≤—É—é —Å—Ç–∞–≤–∫—É.');
      if(!years || isNaN(years)) return alert('–í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π —Å—Ä–æ–∫ –≤ –≥–æ–¥–∞—Ö.');

      const n = years*12;
      const r = annualRate/100/12;
      let monthly = 0;
      if(r===0) monthly = P / n; else monthly = P * (r * Math.pow(1+r,n)) / (Math.pow(1+r,n)-1);
      const monthlyWithExtra = monthly + extraPay;

      // –§–æ—Ä–º–∏—Ä—É–µ–º –≥—Ä–∞—Ñ–∏–∫ –∞–º–æ—Ä—Ç–∏–∑–∞—Ü–∏–∏
      let balance = P;
      const schedule = [];
      let totalPaid = 0; let totalInterest = 0;
      let month=1;
      while(balance > 0.01 && month <= 1000){ // –∑–∞—â–∏—Ç–∞ –æ—Ç –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ–≥–æ —Ü–∏–∫–ª–∞
        const interest = balance * r;
        let principal = monthly - interest;
        if(principal < 0) principal = 0; // –Ω–∞ —Å–ª—É—á–∞–π –æ—á–µ–Ω—å –Ω–∏–∑–∫–∏—Ö –ø–ª–∞—Ç–µ–∂–µ–π
        // –µ—Å–ª–∏ –µ–∂–µ–º–µ—Å—è—á–Ω—ã–π —Å –¥–æ–ø–ª–∞—Ç–æ–π –±–æ–ª—å—à–µ –æ—Å—Ç–∞—Ç–∫–∞+interest ‚Äî –¥–µ–ª–∞–µ–º –ø–æ—Å–ª–µ–¥–Ω–∏–π –ø–ª–∞—Ç—ë–∂
        let payment = monthlyWithExtra;
        if(payment > balance + interest) payment = balance + interest;
        // —Ä–∞–∑–¥–µ–ª—è–µ–º –Ω–∞ –ø—Ä–æ—Ü–µ–Ω—Ç—ã –∏ –æ—Å–Ω–æ–≤–Ω—É—é —Å—É–º–º—É
        const interestPart = Math.min(interest, payment);
        const principalPart = Math.max(0, payment - interestPart);
        balance = Math.max(0, balance - principalPart);

        schedule.push({month, payment, principal:principalPart, interest:interestPart, balance});
        totalPaid += payment; totalInterest += interestPart;
        month++; if(month>n && balance>0){/* –µ—Å–ª–∏ —Å—Ä–æ–∫ –∫–æ–Ω—á–∏–ª—Å—è, –Ω–æ –æ—Å—Ç–∞–ª—Å—è –±–∞–ª–∞–Ω—Å ‚Äî –ø—Ä–æ–¥–æ–ª–∂–∞–µ–º */}
      }

      // –í—ã–≤–æ–¥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
      monthlyEl.textContent = fmtMoney2(monthlyWithExtra);
      totalPaidEl.textContent = fmtMoney2(totalPaid);
      totalInterestEl.textContent = fmtMoney2(totalInterest);
      results.style.display = 'block';

      // –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã
      function renderRows(limit){
        tableBody.innerHTML='';
        let rows = schedule;
        if(limit !== 'all') rows = schedule.slice(0, Number(limit));
        rows.forEach(rw=>{
          const tr = document.createElement('tr');
          tr.innerHTML = `<td style="text-align:left">${rw.month}</td><td>${fmtMoney2(rw.payment)}</td><td>${fmtMoney2(rw.principal)}</td><td>${fmtMoney2(rw.interest)}</td><td>${fmtMoney2(rw.balance)}</td>`;
          tableBody.appendChild(tr);
        })
      }
      renderRows(showRows.value);

      // Download CSV
      downloadCsv.onclick = ()=>{
        let csv = '–ú–µ—Å—è—Ü,–ü–ª–∞—Ç—ë–∂,–û—Å–Ω–æ–≤–Ω–æ–π –¥–æ–ª–≥,–ü—Ä–æ—Ü–µ–Ω—Ç—ã,–û—Å—Ç–∞—Ç–æ–∫\n';
        schedule.forEach(s=>{
          csv += `${s.month},${s.payment.toFixed(2)},${s.principal.toFixed(2)},${s.interest.toFixed(2)},${s.balance.toFixed(2)}\n`;
        });
        const blob = new Blob([csv], {type:'text/csv;charset=utf-8;'});
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a'); a.href = url; a.download = 'amortization.csv'; document.body.appendChild(a); a.click(); a.remove(); URL.revokeObjectURL(url);
      }

      printBtn.onclick = ()=>{ window.print(); }

      showRows.onchange = ()=> renderRows(showRows.value);

      // —Å–æ—Ö—Ä–∞–Ω—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ
      saveState();
    }

    calc.addEventListener('click', calcMortgage);
    clear.addEventListener('click', ()=>{ if(confirm('–°–±—Ä–æ—Å–∏—Ç—å —Ñ–æ—Ä–º—É –∏ —É–¥–∞–ª–∏—Ç—å –ª–æ–∫–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ?')){ localStorage.removeItem(LS_KEY); localStorage.removeItem(OFFERS_KEY); amount.value=''; rate.value=''; term.value=''; down.value=''; extra.value=''; bankName.value=''; bankRate.value=''; tableBody.innerHTML=''; results.style.display='none'; loadOffers(); } });

    // –ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ
    loadState(); loadOffers();

    // –°–æ—Ö—Ä–∞–Ω—è—Ç—å –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö
    [amount,rate,term,down,extra].forEach(el=>el.addEventListener('input', saveState));

  </script>
</body>
</html>
